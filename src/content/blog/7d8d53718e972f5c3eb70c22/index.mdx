---
title: 'UnJSè£½ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ»cittyã‚’ä½¿ã£ã¦Node.jsã§ã•ãã£ã¨CLIã‚’ä½œã‚‹'
description: 'cittyã‚’ä½¿ã£ã¦ã¿ãŸã¨ã“ã‚ã‚ã£ã¡ã‚ƒè‰¯ã‹ã£ãŸã®ã§ãƒ¡ãƒ¢ãŒã¦ã‚‰ã‚¨ãƒ³ãƒˆãƒªã‚’æ›¸ãã€‚'
date: 2025-02-27
tags: ['UnJS', 'TypeScript']
image: '../../../../public/static/1200x630.png'
authors: ['Kanon']
---

# citty

https://unjs.io/packages/citty

Nitroã¨ã‹h3ã¨ã‹ã„ã‚ã„ã‚ã„ã„æ„Ÿã˜ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½œã£ã¦ã‚‹UnJSã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸€ã¤ã€‚ã„ã„æ„Ÿã˜ã«CLIãƒ„ãƒ¼ãƒ«ã‚’ä½œã‚Œã‚‹ã€‚

# æº–å‚™

```bash
npm install citty
```

å…¬å¼ã®ã‚µãƒ³ãƒ—ãƒ«ã‚½ãƒ¼ã‚¹ã‚’æ‹å€Ÿã€‚

```typescript
import { defineCommand, runMain } from "citty";

const main = defineCommand({
    meta: {
        name: "hello",
        version: "1.0.0",
        description: "My Awesome CLI App",
    },
    args: {
        name: {
            type: "positional",
            description: "Your name",
            required: true,
        },
        friendly: {
            type: "boolean",
            description: "Use friendly greeting",
        },
    },
    run({ args }) {
        console.log(`${args.friendly ? "Hi" : "Greetings"} ${args.name}!`);
    },
});

runMain(main);
```

# åŸºæœ¬

ä»¥ä¸‹ã€ã‚ãˆã¦é–“é•ã£ãŸå‹•ã‹ã—æ–¹ã‚’ã—ã¦ã¿ã‚‹ã€‚

```bash
node --experimental-strip-types index.ts
```

![](2025-04-15-20-49-42.png)

ã‹ãªã‚Šè¦ªåˆ‡ã«æ€’ã£ã¦ãã‚Œã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã—ã§å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨â€¦

```bash
node --experimental-strip-types index.ts Kanon
```

![](2025-04-15-20-49-53.png)

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã¤ã‘ã‚‹ã€‚

```bash
node --experimental-strip-types index.ts Kanon --friendly true
```

ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ã«ãªã£ãŸã€‚

![](2025-04-15-20-50-15.png)

# argsã®typeã«ã¤ã„ã¦

```
    args: {
        name: {
            type: "positional",
            description: "Your name",
            required: true,
        },
        friendly: {
            type: "boolean",
            description: "Use friendly greeting",
        },
    },
```

ã“ã“ã§è©¦ã—ã«`type`ã«`number`ã‚’æŒ‡å®šã—ã¦ã¿ã‚‹ã¨æ€’ã‚‰ã‚Œã‚‹ã€‚

![](2025-04-15-20-50-31.png)

å®Ÿè£…ã‚’ã¿ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã‚‹ã€‚

```typescript
type ArgType = "boolean" | "string" | "positional" | undefined;
```

ã©ã†ã‚„ã‚‰4ã¤ã‚’æŒ‡å®šã§ãã‚‹ã‚‰ã—ã„ã€‚`string`, `boolean`ã¯ã‚ã‹ã‚‹ãŒ`positional`ã¨ã¯ãªã«ã‹ã€‚ã“ã‚Œã¯`--help`ã§è¦‹ã¦ã¿ã‚‹ã¨ã‚ã‹ã‚‹ã€‚ã¾ãšã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å¼•æ•°ã‚’å®šç¾©ã—ã¦`--help`ã™ã‚‹ã€‚

```typescript
    args: {
        name: {
            type: "positional",
            description: "Your name",
            required: true,
        },
        friendly: {
            type: "boolean",
            description: "Use friendly greeting",
        },
        repeat: {
            type: "string",
            description: "Number of times to repeat the greeting",
            default: "2",
        },
    },
```

helpã‚‚ã‚ã£ã¡ã‚ƒã‚ã‹ã‚Šã‚„ã™ã„ã€‚

![](2025-04-15-20-50-45.png)

ã§ã¯æ¬¡ã«ã€`friendly`ã‚’`positional`ã«å¤‰ãˆã¦ã¿ã‚‹ã€‚

```diff
    args: {
        name: {
            type: "positional",
            description: "Your name",
            required: true,
        },
        friendly: {
-            type: "boolean",
+            type: "positional",
            description: "Use friendly greeting",
        },
        repeat: {
            type: "string",
            description: "Number of times to repeat the greeting",
            default: "2",
        },
    },
```

![](2025-04-15-20-50-58.png)

`--friendly`ã‹ã‚‰`FRIENDLY`ã«å¤‰ã‚ã£ãŸã®ãŒã‚ã‹ã‚‹ã ã‚ã†ã‹ã€‚ã¤ã¾ã‚Šã€ã€Œ`positional`ã¯`args`ã«æŒ‡å®šã•ã‚ŒãŸé †ç•ªã§å—ã‘å–ã‚‹ã‚ˆã€ã¨ã„ã†ã“ã¨ã‚‰ã—ã„ã€‚è©¦ã—ã«ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè¡Œã—ã¦ã¿ã‚‹ã¨â€¦

```bash
node --experimental-strip-types index.ts Kanon
```

`FRIENDLY`ã‚’æŒ‡å®šã—ã‚ã¨æ€’ã‚‰ã‚ŒãŸã€‚

![](2025-04-15-20-51-17.png)

# ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰

ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«äºŒã¤ã®ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè£…ã—ã¦ã¿ã‚‹ã€‚

```typescript
import { defineCommand, runMain } from "citty";

const greet = defineCommand({
    meta: {
        name: "greet",
        description: "Greet someone",
    },
    args: {
        name: {
            type: "positional",
            description: "Your name",
            required: true,
        },
        friendly: {
            type: "boolean",
            description: "Use friendly greeting",
        },
    },
    run({ args }) {
        console.log(`${args.friendly ? "Hi" : "Greetings"} ${args.name}!`);
    },
});

const byebye = defineCommand({
    meta: {
        name: "byebye",
        description: "Goodbye someone",
    },
    args: {
        name: {
            type: "positional",
            description: "Your name",
            required: true,
        },
    },
    run({ args }) {
        console.log(`byebyeğŸ‘‹ ${args.name}!`);
    },
});

const main = defineCommand({
    meta: {
        name: "hello",
        version: "1.0.0",
        description: "My Awesome CLI App",
    },
    subCommands: {
        greet,
        byebye,
    },
});

runMain(main);
```

ãƒ˜ãƒ«ãƒ—ã‚’è¦‹ã‚‹ã€‚

![](2025-04-15-20-51-35.png)

ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ã®ãƒ˜ãƒ«ãƒ—ã‚’è¦‹ã‚‹ã«ã¯`--help`ã®å¾Œã‚ã«ç¶šã‘ã‚‹ã¨ã„ã„ã‚‰ã—ã„ã€‚è©¦ã—ã«`byebye`ã‚’è¦‹ã‚‹ã€‚

```bash
node --experimental-strip-types index.ts --help byebye
```

![](2025-04-15-20-51-47.png)

ãã‚Œãã‚Œå®Ÿè¡Œã—ã¦ã¿ã‚‹ã€‚

```bash
node --experimental-strip-types index.ts greet Kanon
```

![](2025-04-15-20-51-57.png)

```bash
node --experimental-strip-types index.ts byebye Kanon
```

![](2025-04-15-20-52-07.png)

# setup, cleanup

`setup`, `cleanup`ã¯`run`ã®å‰å¾Œã«å®Ÿè¡Œã™ã‚‹å‡¦ç†ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚å¼•æ•°ã«`args`ã‚’æŒ‡å®šã™ã‚Œã°ã€ãã‚‚ãã‚‚å±¥æ­´ã‚’å–ã‚‰ãªããªã‚‹ã€‚

```
  setup({ args }){
    console.log(`now setup ${args.command}`);
  },
  cleanup({ args }){
    console.log(`now cleanup ${args.command}`);
  },
```

# ãŠã‚ã‚Šã«

ãŠæ°—ã¥ãã®æ–¹ã‚‚ã„ã‚‰ã£ã—ã‚ƒã‚‹ã ã‚ã†ãŒã€`node --experimental-strip-types`ã‚’ãšã£ã¨ä½¿ã£ã¦TSã‚’ãã®ã¾ã¾Nodeã§å®Ÿè¡Œã—ã¦ã„ã‚‹ã€‚`citty`è‡ªä½“ã‚‚ã‚ã£ã¡ã‚ƒã‚·ãƒ³ãƒ—ãƒ«ã§ä¾¿åˆ©ã ã‘ã©ã€`--experimental-strip-types`ãŒã‚ã‚‹ã“ã¨ã§ä¸€å±¤ã„ã„æ„Ÿã˜ã€‚

---

ã“ã®è¨˜äº‹ã¯å½“åˆã¯ã¦ãªãƒ–ãƒ­ã‚°ã§å…¬é–‹ã—ãŸã‚‚ã®ã‚’å€‹äººãƒ–ãƒ­ã‚°é–‹è¨­ã«ã‚ãŸã£ã¦ç§»æ¤ã—ãŸã‚‚ã®ã§ã™ã€‚

https://blog.inorinrinrin.com/entry/2025/02/26/232548
